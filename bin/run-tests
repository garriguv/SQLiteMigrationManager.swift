#!/bin/bash

set -euo pipefail

main() {
  xcodebuild \
    -workspace SQLiteMigrationManager.xcworkspace \
    -scheme "SQLiteMigrationManager iOS" \
    -sdk iphonesimulator15.0 \
    -destination "platform=iOS Simulator,name=iPhone 12,OS=15.0"\
    test
  xcodebuild \
    -workspace SQLiteMigrationManager.xcworkspace \
    -scheme "SQLiteMigrationManager macOS" \
    -sdk macosx11.3 \
    -destination "arch=x86_64" \
    test
  swift build
}
main "$@"
