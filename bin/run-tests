#!/bin/bash

set -euo pipefail

main() {
  xcodebuild \
    -workspace SQLiteMigrationManager.xcworkspace \
    -scheme "SQLiteMigrationManager iOS" \
    -sdk iphonesimulator17.5 \
    -destination "platform=iOS Simulator,name=iPhone 15,OS=18.1"\
    test
  xcodebuild \
    -workspace SQLiteMigrationManager.xcworkspace \
    -scheme "SQLiteMigrationManager macOS" \
    -sdk macosx14.5 \
    -destination "arch=x86_64" \
    test
  swift build
}
main "$@"
